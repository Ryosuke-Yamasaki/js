<!doctype html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>JavaScriptによる計算</title>
    </head>

    <body>
        <h1>RSA暗号</h1>
        
        <form name = "form1">
            N = <input type="text" id="Nstr" /> <br>	
            n = <input type="text" id="nstr" /> <br>	
            e = <input type="text" id="estr" /> <p>
            暗号化する文字列 → <input type="text" id="Xstr" /> <p>	
	

            <button type="button" onclick="calc();"> 実行</button> <br>
            <hr>
            C = <input type="text" id="Cstr" /><br>
            d = <input type="text" id="dstr" /><br>
        </form>

        <script type="text/javascript">
            function calc() {
                var X = document.getElementById("Xstr").value
                var N = document.getElementById("Nstr").value
                var n = document.getElementById("nstr").value
                var e = document.getElementById("estr").value
                var Alphabet = new Array ("A","I","U","E","O","K","S","N")
                var P = 0
                
                //平文を数字に置き換える
                for(var i = 0;i < X.length;i ++){ //i文字目の数値化
                    for(var j = 0;j < N;j ++){
                        if(X.charAt(i) == Alphabet[j]){
                            P += j * (N ** (X.length - 1 - i))
                        }
                    }
                }

                //暗号文の数値を求める 
                var c = P
                for(var k = 0;k < (e - 1);k ++){
                    c = (c * P) % n
                }

                //暗号文にする
                var C = c.toString(N)
                for(var l = 0;l < C.length;l ++){
                    form1.Cstr.value += Alphabet[C.charAt(l)]
                }

                //復号化鍵を求める
                var a = e
                var b = 572
                var r = a % b
                var Q = a / b | 0

                var x0 = 1
                var y0 = 0

                var x1 = Q
                var y1 = 1

                var s , t
                var z = -1
            
                while(r > 0){
                    a = b
                    b = r
                    r = a % b
                    Q = a / b | 0

                    t = x1
                    x1 = Q*t + x0
                    x0 = t

                    s = y1
                    y1 = Q*s + y0
                    y0 = s
                    z = -z
                }
                var d = y0 * z
                form1.dstr.value = d
            }
        </script>
    </body>
</html>